<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tr√≤ ch∆°i 3‚Äë5‚Äë7</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    .row { display: flex; justify-content: center; margin: 10px; padding: 10px; }
    .row-label { width: 100px; font-weight: bold; align-self: center; }
    .coins { display: flex; }
    .coin { width: 40px; height: 40px; border-radius: 50%; margin: 5px; cursor: pointer; }
    .coin.selected { background-color: limegreen !important; }
    .controls { margin-top: 20px; }
    .rules { margin-top: 40px; padding: 15px; border: 1px solid #ccc; border-radius: 10px; max-width: 600px; margin: 0 auto; background-color: #f9f9f9; text-align: left; }
    #fireworks { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 1000; display: none; }
  </style>
</head>
<body>
  <h1>Tr√≤ ch∆°i 3‚Äë5‚Äë7</h1>
  <div id="rows">
    <div class="row" data-row="0"><div class="row-label">H√†ng 1</div><div class="coins"></div></div>
    <div class="row" data-row="1"><div class="row-label">H√†ng 2</div><div class="coins"></div></div>
    <div class="row" data-row="2"><div class="row-label">H√†ng 3</div><div class="coins"></div></div>
  </div>
  <div class="controls">
    <button onclick="confirmMove()">X√°c nh·∫≠n l∆∞·ª£t b·ªëc</button>
    <p id="status">L∆∞·ª£t c·ªßa ng∆∞·ªùi ch∆°i¬†1</p>
  </div>
  <div class="rules">
    <h3>Lu·∫≠t ch∆°i:</h3>
    <ul>
      <li>Tr√≤ ch∆°i g·ªìm 3 h√†ng ƒë·ªìng xu: 3, 5 v√† 7.</li>
      <li>M·ªói l∆∞·ª£t, ng∆∞·ªùi ch∆°i ƒë∆∞·ª£c l·∫•y √≠t nh·∫•t 1 ƒë·ªìng xu, nh∆∞ng ch·ªâ trong m·ªôt h√†ng duy nh·∫•t.</li>
      <li>Ng∆∞·ªùi b·ªëc ƒë·ªìng xu cu·ªëi c√πng s·∫Ω l√† ng∆∞·ªùi chi·∫øn th·∫Øng.</li>
    </ul>
  </div>
  <canvas id="fireworks"></canvas>
<script>
  const rows = [3,5,7];
  const gameRows = document.querySelectorAll('.row');
  let currentPlayer = 1;
  let selectedCoins = [];
  const rowColors = ['blue','red','gold'];
  function createCoins(){
    rows.forEach((count,rowIndex)=>{
      const coins = gameRows[rowIndex].querySelector('.coins');
      coins.innerHTML = '';
      for(let i=0;i<count;i++){
        const coin = document.createElement('div');
        coin.className = 'coin';
        coin.style.backgroundColor = rowColors[rowIndex];
        coin.dataset.row = rowIndex;
        coin.onclick = () => toggleSelect(coin);
        coins.appendChild(coin);
      }
    });
  }
  function toggleSelect(coin){
    const row = coin.dataset.row;
    if(selectedCoins.length>0 && selectedCoins[0].dataset.row !== row) {
      alert('Ch·ªâ ƒë∆∞·ª£c ch·ªçn ƒë·ªìng xu trong c√πng m·ªôt h√†ng!');
      return;
    }
    if(coin.classList.contains('selected')) {
      coin.classList.remove('selected');
      selectedCoins = selectedCoins.filter(c=>c!==coin);
    } else {
      coin.classList.add('selected');
      selectedCoins.push(coin);
    }
  }
  function confirmMove(){
    if(selectedCoins.length===0) {
      alert('Ch∆∞a ch·ªçn ƒë·ªìng xu n√†o!');
      return;
    }
    selectedCoins.forEach(c=>c.remove());
    selectedCoins=[];
    currentPlayer = 3 - currentPlayer;
    document.getElementById('status').innerText = `L∆∞·ª£t c·ªßa ng∆∞·ªùi ch∆°i¬†${currentPlayer}`;
    checkWin();
  }
  function checkWin(){
    if(document.querySelectorAll('.coin').length === 0){
      document.getElementById('status').innerText = `üéâ Ch√∫c m·ª´ng ng∆∞·ªùi ch∆°i¬†${3 - currentPlayer} ƒë√£ th·∫Øng cu·ªôc! üéâ`;
      startFireworks();
      setTimeout(()=>location.reload(),8000);
    }
  }
  createCoins();
  function startFireworks(){
    const canvas = document.getElementById('fireworks');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    canvas.style.display = 'block';
    let particles = [];
    function createFirework(){
      const colors = ['#ff0000','#ffff00','#00ff00','#00ffff','#ff00ff'];
      const x = Math.random()*canvas.width;
      const y = Math.random()*canvas.height/2;
      for(let i=0;i<100;i++){
        particles.push({
          x, y,
          dx:(Math.random()-0.5)*5,
          dy:(Math.random()-0.5)*5,
          life:100,
          color: colors[Math.floor(Math.random()*colors.length)]
        });
      }
    }
    function animate(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      particles.forEach((p,i)=>{
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x,p.y,2,0,Math.PI*2);
        ctx.fill();
        p.x+=p.dx;
        p.y+=p.dy;
        p.life--;
        if(p.life<=0) particles.splice(i,1);
      });
      if(particles.length<50) createFirework();
      requestAnimationFrame(animate);
    }
    animate();
  }
</script>
</body>
</html>
